{% extends 'ClarolineCoreBundle:Workspace:layout.html.twig' %}
{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/jrmunamurcobra/js/cobra.js') }}" type="text/javascript"></script>
{% endblock %}
{% block title %}{{ _resource.resourceNode.name }}{% endblock %}

{% block content %}
<form action="{{ _path('unamur_cobra_viewer_configure', {'cobraViewerId': _resource.id}) }}" method="post" {{ form_enctype(form) }} class="form-horizontal configure_cobra_form">
    <div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a data-toggle="collapse" href="#panel-global">
                                Informations générales
                                {{ form_errors(form) }}
                            </a>
                        </h3>
                    </div>
                    <div id="panel-global" class="panel-body collapse in">
                        {{ form_row(form.name, {'attr': {'value': _resource.resourceNode.name}}) }}
                        {{ form_row(form.language) }}
                    </div>
                </div>


            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a data-toggle="collapse" href="#panel-collections">
                                Choix des collections
                            </a>
                        </h3>
                    </div>

                    <div id="panel-collections" class="panel-body collapse">
                        <h4>Mes collections - {{ regCollections | length }}</h4>
                        {% set index = 0 %}
                        {#<table id="myCollections" class="table table-hover in">

                        </table>#}
                        {% for regCollection in regCollections %}
                            {% set index = index + 1 %}
                            <div class="col-md-5" id="panel{{ index }}" style="border-bottom: 1px solid #EEEEEE;">
                                <div class="pull-right" style="margin-top:10px;">

                                    <a href="#">
                                        <button type="button" class="btn btn-xs btn-default">
                                            <span class="icon-pencil"></span>
                                        </button>
                                    </a>
                                    {# uncomment to handle unregistration through javascript
                                    will be usable with local cache storage of cobra resources (collection and text definitions)
                                    <button
                                            type="button"
                                            class="cobra-unregister-button btn btn-default"
                                            btn-cobra-collection-id="{{ regCollection.getId() }}"
                                            >
                                        &times;
                                    </button>#}
                                    <a href="{{ path('unamur_cobra_unregister_collection', {'cobraCollectionId': regCollection.getId()}) }}">
                                        <button type="button" class="btn btn-xs btn-default" btn-cobra-collection-id="{{ regCollection.getId() }}">
                                            <i class="icon-remove"></i>
                                        </button>
                                    </a>
                                    <button type="button"
                                            class="btn btn-xs btn-default cobra-collection-move-up {% if loop.first %} disabled {% endif %}"
                                            btn-cobra-collection-id="{{ regCollection.getId() }}">
                                        <i class="icon-arrow-up"></i>
                                    </button>
                                    <button type="button"
                                            class="btn btn-xs btn-default cobra-collection-move-down {% if loop.last %} disabled {% endif %}"
                                            btn-cobra-collection-id="{{ regCollection.getId() }}">
                                        <i class="icon-arrow-down"></i>
                                    </button>
                                    <button type="button"
                                            class="btn btn-xs btn-default cobra-collection-change-visibility"
                                            btn-cobra-collection-id="{{ regCollection.getId() }}">
                                        <i class="
                                        {% if regCollection.isVisible() %}
                                            icon-eye-open
                                        {% else %}
                                            icon-eye-close
                                        {% endif %}
                                        "></i>
                                    </button>
                                </div>
                                <div class="panel-heading">
                                    <a class="collapsed" href="{{ '#collapse' ~ index }}" data-parent="#accordion1" data-toggle="collapse">
                                        <b>{{ regCollection.getName() }}</b>
                                    </a>
                                </div>
                            </div>
                            <div style="clear: both;"></div>
                            <div id="{{ 'collapse' ~ index }}" class="panel-collapse collapse table-responsive col-md-12" >
                                <table id="text-table{{ regCollection.getId() }}" class="table table-striped table-bordered table-condensed" >
                                    <thead>
                                    <tr>
                                        <th>Texte</th>
                                        <th>Source</th>

                                            <th>Type</th>
                                            <th>&nbsp;</th>

                                    </tr>
                                    </thead>
                                    <tbody id="text-table-body{{ regCollection.getId() }}">
                                    {% for text in regCollection.getCobraTexts() %}
                                        <tr id="text{{ text.id }}" class="row-text">
                                            <td>
                                                <a href="{{ path('unamur_cobra_show_text', {'cobraTextId': text.id}) }}">
                                                    {{ text.title | raw }}
                                                </a>
                                            </td>
                                            <td>{{ text.source | raw }}</td>

                                                <td>{{ text.textType }}</td>
                                                <td>
                                                    <button title="monter" type="button" class="btn btn-default cobraText-move-up {% if loop.first  %} disabled {% endif %}"
                                                            btn-cobra-text-id="{{ text.id }}">
                                                        <i title="monter" class="icon-arrow-up"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-default cobraText-move-down {% if loop.last  %} disabled {% endif %}"
                                                            btn-cobra-text-id="{{ text.id }}">
                                                        <i class="icon-arrow-down"></i>
                                                    </button>
                                                    <button type="button" class="btn btn-default cobraText-change-visibility"
                                                            btn-cobra-text-id="{{ text.id }}">
                                                        <i class="
                                                {% if text.isVisible() %}
                                                    icon-eye-open
                                                {% else %}
                                                    icon-eye-close
                                                {%  endif %}
                                                ">
                                                        </i>
                                                    </button>
                                                </td>

                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% endfor %}
                        <hr/>
                        <h4>Collections disponibles - {{ unregCollections | length }}</h4>
                        {% set subindex = 0 %}
                        {% for unregCollection in unregCollections %}
                            {% set subindex = subindex + 1 %}
                            <div class="col-md-5" id="panel{{ subindex }}" style="border-bottom: 1px solid #EEEEEE;">
                                <div class="pull-right" style="margin-top:10px;">
                                    <a href="{{ path('unamur_cobra_register_collection', {'cobraViewerId': _resource.getId(), 'cobraRemoteCollectionId': unregCollection.getRemoteId()}) }}">
                                        <button class="btn btn-xs btn-default add-collection-button">
                                            <i class="icon-plus"></i>
                                        </button>
                                    </a>
                                </div>
                                <div class="panel-heading">
                                    <a class="collapsed" href="{{ '#subcollapse' ~ subindex }}" data-parent="#accordion2" data-toggle="collapse">
                                        <b>{{ unregCollection.getName() }}</b>
                                    </a>
                                </div>
                            </div>

                            <div style="clear: both;"></div>
                            <div id="{{ 'subcollapse' ~ subindex }}" class="panel-collapse collapse table-responsive col-md-12" >
                                <table id="text-table{{ unregCollection.getRemoteId() }}" class="table table-striped table-bordered table-condensed" >
                                    <thead>
                                    <tr>
                                        <th>Texte</th>
                                        <th>Source</th>
                                    </tr>
                                    </thead>
                                    <tbody id="text-table-body{{ unregCollection.getRemoteId() }}">
                                    {% for text in unregCollection.getRemoteTexts() %}
                                        {% for text in unregCollection.getRemoteTexts() %}
                                            <tr id="remotetext{{ text.id }}" class="row-text">
                                                <td style="vertical-align:middle;">{{ text.title | raw }}</td>
                                                <td style="vertical-align:middle;">{{ text.source | raw }}</td>
                                            </tr>
                                        {% endfor %}
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% endfor %}
                    </div>

                </div>


            </div>
        </div>

        <div class="row">
            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a data-toggle="collapse" href="#panel-display">
                                Paramètres d'affichage
                            </a>
                        </h3>

                    </div>
                    <div id="panel-display" class="panel-body collapse">
                        {% if form.language.vars['value'] == 'EN' %}
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_display_gender' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">{{ form_widget(form.display_gender) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_display_inflected_forms' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6"> {{ form_widget(form.display_inflected_forms) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_translations_display_mode' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">{{ form_widget(form.translations_display_mode) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_descriptions_display_mode' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">{{ form_widget(form.descriptions_display_mode) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_examples_display_mode' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">{{ form_widget(form.examples_display_mode) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_display_occurrences' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6"> {{ form_widget(form.display_occurrences) }}</div>
                        </div>
                        <div class="form-group row">
                            <label class="control-label col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                {{ 'unamur_cobra_config_form_display_illustrations' | trans({}, 'unamur_cobra') }}
                            </label>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6"> {{ form_widget(form.display_illustrations) }}</div>
                        </div>

                       {# <div class="checkbox">

                        </div>#}
                        {% endif %}
                        {#{{ form_widget(form.display_inflected_forms) }}
                        {{ form_widget(form.translations_display_mode) }}
                        {{ form_rest(form) }}#}
                    </div>
                </div>
            </div>

            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <a data-toggle="collapse" href="#panel-corpus">
                                Sélection des corpus

                                {{ form_rest(form) }}
                            </a>
                        </h3>
                        {% for item in  corpus %}
                            <p>{{ item.name }}</p>
                        {% endfor %}
                    </div>

                    <div id="panel-corpus" class="panel-body collapse in">
                        <table id="corpus-selection-table" class="table table-hover in">
                            <thead>
                                <tr>
                                    <th> &nbsp; </th>
                                    <th> Type de corpus </th>
                                    <th> Ordre </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <input name="1" value="true" checked="checked" type="checkbox">
                                    </td>
                                    <td class="usuel_FUNDP"> édités par UNamur</td>
                                    <td>
                                        <select name="ordre1">
                                        <option value="">&nbsp; </option><option value="1" selected="selected">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="11" value="true" checked="checked" type="checkbox"></td><td class="usuel"> langue usuelle</td><td> <select name="ordre11">
                                        <option value="">&nbsp; </option><option value="1">1</option><option value="2" selected="selected">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="21" value="true" checked="checked" type="checkbox"></td><td class="semi-technique"> politique</td><td> <select name="ordre21">
                                        <option value="">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3" selected="selected">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="22" value="true" type="checkbox"></td><td class="technique"> droit</td><td> <select name="ordre22">
                                        <option value="" selected="selected">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="32" value="true" type="checkbox"></td><td class="histoire"> art et histoire</td><td> <select name="ordre32">
                                        <option value="" selected="selected">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="42" value="true" type="checkbox"></td><td class="informatique"> informatique</td><td> <select name="ordre42">
                                        <option value="" selected="selected">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="52" value="true" type="checkbox"></td><td class="sciences"> sciences et techniques</td><td> <select name="ordre52">
                                        <option value="" selected="selected">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td><input name="62" value="true" checked="checked" type="checkbox"></td><td class="eco"> économie</td><td> <select name="ordre62">
                                        <option value="">&nbsp; </option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4" selected="selected">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select>
                                </td></tr><tr><td colspan="3" style="text-align:center;">
                                    <input value="Ok" name="submit" type="submit">&nbsp;
                                    <a href="index.php"><input onclick="document.location='index.php';return false" value="Annuler" type="button"></a>
                                </td></tr>
                            </tbody></table>

                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">{{ 'cancel' | trans({}, 'platform') }}</button>
            <button type="submit" class="btn btn-primary">{{ 'ok' | trans({}, 'platform') }}</button>
        </div>
    </div>
</form>
    {# form action="{{ _path('unamur_cobra_configure', {'cobraViewerId': _resource.id}) }}" method="post" {{ form_enctype(form) }} class="form-horizontal well configure_cobra_form">
        <legend>{{ "configure_cobra" | trans({}, 'unamur_cobra') }}</legend>
        {{ form_errors(form) }}
        <div class="checkbox">
            <label>
                {{ form_widget(form.display_gender) }} {{ 'unamur_cobra_config_form_display_gender' | trans({}, 'unamur_cobra') }}
            </label>
        </div>
        <div class="checkbox">
            <label>
                {{ form_widget(form.display_inflected_forms) }} {{ 'unamur_cobra_config_form_display_inflected_forms' | trans({}, 'unamur_cobra') }}
            </label>
        </div>
        <div class="checkbox">
            <label>
                {{ form_widget(form.display_occurrences) }} {{ 'unamur_cobra_config_form_display_occurrences' | trans({}, 'unamur_cobra') }}
            </label>
        </div>
        <div class="checkbox">
            <label>
                {{ form_widget(form.display_illustrations) }} {{ 'unamur_cobra_config_form_display_illustrations' | trans({}, 'unamur_cobra') }}
            </label>
        </div>
        <div class="checkbox">
            <label>
                {{ form_widget(form.show_media_player) }} {{ 'unamur_cobra_config_form_show_media_player' | trans({}, 'unamur_cobra') }}
            </label>
        </div>
        {{ form_rest(form) }}
        <div clas="form-actions">
            <button type="submit" class="btn btn-primary">{{ 'configure' | trans({}, 'platform') }}</button>
            <a href="http://localhost:8081/claconn/web/app_dev.php/desktop/tool/open/resource_manager#" title="{{ 'cancel' | trans({}, 'platform') }}" class="btn btn-danger">{{ 'cancel' | trans({}, 'platform') }}</a>
        </div>
    </form>
    {% block stylesheets %}
    {{ parent() }}
    {% stylesheets debug=false filter='lessphp'  output='bundles/unamurcobra/css/style.css'
    "@JrmUnamurCobraBundle/Resources/views/less/style.less"
    %}<link rel="stylesheet" href="{{ asset_url }}" screen="media" />
    {% endstylesheets %}
    {% endblock %} #}

{% endblock %}
